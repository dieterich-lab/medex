{# Numeric tab. Using bootstrap classes. The tab container (div.#statistics) and navigation links (ul#statistics_tab)
are defined in basic_stats.html. #}

<script type="module" src="{{ url_for('static', filename='js/basic_stats_numerical.js') }}"></script>

<div class="tab-pane fade {% if numeric_tab %}show active{% endif %}" id="numeric_tab" role="tabpanel"
     aria-labelledby="n_settings_header">
    <div id="numeric_accordion">
        <div class="card">
            <div class="card-header" id="n_settings_header">
                <h5 class="mb-0">
                    <button type="button" class="btn btn-link" data-toggle="collapse" data-target="#numeric_settings"
                            {% if not numeric_entities %} aria-expanded="true" {% endif %}
                            aria-controls="numeric_settings">
                        Settings
                    </button>
                </h5>
            </div>
            <div id="numeric_settings" class="collapse show"
                 aria-labelledby="n_settings_header" data-parent="#numeric_accordion">
                <div class="card-body">
                    {% import 'macro_template.html' as m %}
                    {% if error %}
                    {{ m.show_error(error) }}
                    {% endif %}

                    {{ m.entity_form_measurement_multiple(id_multi_measurement="measurement_numeric",name
                    =measurement_tuple[0],class="measurement",value=entity,select=measurement_numeric,d=measurement_tuple[1],block=measurement_tuple[2]) }}
                    <div class="form-group">
                        <label for="basic_stats_numerical_entities_select">Numeric entities:</label>
                        <select id="basic_stats_numerical_entities_select" name="numeric_entities_multiple" multiple style="width: 100%" class="js-example-basic-single"
                                data-entity-types="Double"
                        >
                        </select>
                    </div>
                    <button id="Result_categorical" name="basic_stats" class="btn btn-outline-info" >Result</button>
                </div>
            </div>

            <div class="card">
                <div class="card-header" id="results_header">
                    <h5 class="mb-0">
                        <button type="button" class="btn btn-link" data-toggle="collapse" data-target="#numeric_results"
                                {% if numeric_entities %} aria-expanded="true" {% endif %}
                                aria-controls="#numeric_results">
                            Results
                        </button>
                    </h5>
                </div>

                <div id="numeric_results" class="collapse {% if numeric_entities %} show {% endif %}"
                     aria-labelledby="n_results_header" data-parent="#numeric_accordion">
                    <div class="card-body">
                        {% if basic_stats %}
                        <table class="table table-stripped">
                            <thead>
                            <tr>
                                <th>Entity</th>
                                {% if measurement_tuple[2] != 'none' %}
                                <th>{{ measurement_name }}</th>
                                {% endif %}
                                {% if 'count' in basic_stats %}
                                <th>Counts</th>
                                {% endif %}
                                {% if 'count NaN' in basic_stats %}
                                <th title="Number of patients with missing entity value">Counts NaN</th>
                                {% endif %}
                                {% if 'min' in basic_stats %}
                                <th>Min</th>
                                {% endif %}
                                {% if 'max' in basic_stats %}
                                <th>Max</th>
                                {% endif %}
                                {% if 'mean' in basic_stats %}
                                <th>Mean</th>
                                {% endif %}
                                {% if 'median' in basic_stats %}
                                <th>Median</th>
                                {% endif %}
                                {% if 'stddev' in basic_stats %}
                                <th>Std. Deviation</th>
                                {% endif %}
                                {% if 'stderr' in basic_stats %}
                                <th>Std. Error</th>
                                {% endif %}
                            </tr>
                            </thead>
                            <tbody>
                            {% for entity in numeric_entities %}
                            {% for m in measurement_numeric %}
                            <tr>
                                {% if basic_stats[first_value][entity,m] is defined %}
                                <td>{{ entity }}</a></td>
                                {% if measurement_tuple[2] != 'none' %}
                                <td>{{ m }}</td>
                                {% endif %}
                                {% if 'count' in basic_stats %}
                                <td>{{ basic_stats['count'][entity,m] }}</td>
                                {% endif %}
                                {% if 'count NaN' in basic_stats %}
                                <td>{{ basic_stats['count NaN'][entity,m] }}</td>
                                {% endif %}
                                {% if 'min' in basic_stats %}
                                <td>{{ basic_stats['min'][entity,m] }}</td>
                                {% endif %}
                                {% if 'max' in basic_stats %}
                                <td>{{ basic_stats['max'][entity,m] }}</td>
                                {% endif %}
                                {% if 'mean' in basic_stats %}
                                <td>{{ basic_stats['mean'][entity,m] }}</td>
                                {% endif %}
                                {% if 'median' in basic_stats %}
                                <td>{{ basic_stats['median'][entity,m] }}</td>
                                {% endif %}
                                {% if 'stddev' in basic_stats %}
                                <td>{{ basic_stats['stddev'][entity,m] }}</td>
                                {% endif %}
                                {% if 'stderr' in basic_stats %}
                                <td>{{ basic_stats['stderr'][entity,m] }}</td>
                                {% endif %}
                                {% endif %}
                            </tr>
                            {% endfor %}
                            {% endfor %}
                            </tbody>
                        </table>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
